<!DOCTYPE html>
<html lang = "en">
<head>
	<meta charset="utf-8" />
	<title>Invent치rio</title>
	<link rel="stylesheet" href="css/style.css" media="all">
</head>
<body>
	<div id="start" class="none">
		<div id="overlay-color">
		</div>
		<div id="start-box">
			<p id="intro">Texto inicial que poder치 mudar de acordo com o mouse</p>
		</div>
	</div>
	<header>
		<figure>
			<a id="save"><img src="img/logo.png"/></a>
		</figure>
		<figure>
			<a id="refresh"><img src="img/logo.png"/></a>
		</figure>
		<p id="click-again" class="none">CLICK AGAIN</p>
	</header>
	<div id="screenshot">
		<div id='icon-layer'>
		</div>
		<figure>
			<a href="http://pedroveneziano.com"><img id="logo" src="img/logo.png"/></a>
		</figure>
		<figure>
			<img id="background" src="" width="2560px"/>
		</figure>
	</div>
	<script src="html2canvas.js"></script>
	<script>

	(function(){

		//BACKGROUND IMAGE//

		var bgImage = document.getElementById("background");

		randomizeBg = function() {
			var randomBgNumber = Math.round(Math.random() * 4);
			bgImage.setAttribute('src', 'img/bg-' + randomBgNumber + '.jpg');
		}

		randomizeBg();

		//RANDOM ICON//

	  	var placeNewIcon = function(e) {

	  		_x = e.pageX;
	 		_y = e.pageY;
	 		var newIcon = document.createElement('img');
	 		var randomIconNumber = Math.round(Math.random() * 4);
	 		newIcon.setAttribute('src', 'img/icon-' + randomIconNumber + '.png');
	 		newIcon.setAttribute('class', 'icon');
	 		newIcon.setAttribute('style', 'top: ' + (_y - 120) + 'px; left: ' + (_x - 150) + 'px; z-index: ' + _y);
	 		var iconLayer = document.getElementById('icon-layer');
	 		iconLayer.appendChild(newIcon);
	  	}

	  	bgImage.addEventListener('click', placeNewIcon);

	  	//SAVE SCREENSHOT

	  	var savedContent = document.getElementById("screenshot");
	  	var savingButton = document.getElementById("save");
	  	var clickAgain = document.getElementById("click-again");

	  	var clickCounter = 0;

		 
		var generatePng = function()  {
			
			html2canvas(savedContent, {
				width: window.innerWidth,
		        height: window.innerHeight,
		        onrendered: function(canvas) {
		        	savingButton.href = canvas.toDataURL();
		        	savingButton.download = "Invent치rio.png";
		        }
		    }) 

			clickCounter = clickCounter + 1;

			if (clickCounter == 1) {
				clickAgain.classList.remove("none");
				console.log(1);
			} else if (clickCounter == 2) {
				clickAgain.classList.add("none");
				console.log(2);
			}

		}
		
		savingButton.addEventListener('click', generatePng);

		//INITIAL SCREEN

		var startScreen = document.getElementById("start");

		if (localStorage.refresh === undefined) {
			startScreen.classList.remove("none");
		} else if (localStorage.refresh === '') {
			startScreen.classList.remove("none");
		} else {
			localStorage.setItem('refresh', '')
		}

		startScreen.addEventListener('click', function() {
			startScreen.classList.add("none");
		});

		//CHANGE LANGUAGE

		var portugues = "Texto inicial que poder치 mudar de acordo com o mouse";
		var english = "Initial text that changes according to the mouse position";

		var intro = document.getElementById('intro');
		//intro.innerHTML = english;

		document.body.addEventListener('mousemove', function(e) {
			
			_x = e.pageX;
	 		if(_x < window.innerWidth * 0.4) {
	 			intro.innerHTML = portugues;
	 		} else if(_x < window.innerWidth) {
	 			intro.innerHTML = english;
	 		}
		});

		//REFRESH BUTTON

		var refresh = document.getElementById('refresh');

		refresh.addEventListener('click', function() {
		
			localStorage.setItem('refresh', 'Refresh');
			location.reload();

		});


	})()
	</script>
</body>
</html>
